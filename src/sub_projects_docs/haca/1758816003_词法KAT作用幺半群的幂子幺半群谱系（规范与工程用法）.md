# 词法KAT作用幺半群的幂子幺半群谱系（规范与工程用法）

- 作者：GaoZheng
- 日期：2025-09-26
- 版本：v1.0.0

## 摘要
介绍 Kleene Algebra with Tests（KAT）与相关闭包/半环结构在本项目中的角色：用以建模可验证控制流、停机点与合规模式。提供从数学结构到工程接口的映射规范，支撑规则检查、代价累积与策略约束的统一表达。

---

下面按“自由幺半群 $M=(\Sigma^*,\circ,\varepsilon)$ 的端算子幺半群 $\mathbb{M}_{\text{Lex-KAT}}=(\mathrm{End}(\Sigma^*),\circ,\mathrm{id})$”给出**词法KAT作用幺半群**的典型**幂子幺半群（power submonoid）**族谱。记“⟨·⟩”为由给定算子及其各次幂（函数自合成）生成的最小子幺半群。

---

1. **左乘幂子幺半群**（历史左扩母形）

$$
\boxed{\ \mathsf{M}_L(h)\ :=\ \langle\,\mathbf L_h\,\rangle\ =\ \{\mathbf L_{h^n}\mid n\!\ge\!0\},\ \ \mathbf L_h(s)=h\circ s\ }
$$

性质：$\mathsf{M}_L(h)\cong(\mathbb N,+,0)$；$\mathbf L_{h^{m}}\circ \mathbf L_{h^{n}}=\mathbf L_{h^{m+n}}$。

2. **右乘幂子幺半群**（预测延展母形）

$$
\boxed{\ \mathsf{M}_R(h)\ :=\ \langle\,\mathbf R_h\,\rangle\ =\ \{\mathbf R_{h^n}\mid n\!\ge\!0\},\ \ \mathbf R_h(s)=s\circ h\ }
$$

性质：$\mathbf R_{h^{m}}\circ \mathbf R_{h^{n}}=\mathbf R_{h^{m+n}}$。

3. **尾裁剪幂子幺半群**（投影带）

$$
\boxed{\ \mathsf{M}_{\text{tail}}(U)\ :=\ \langle\,\boldsymbol\Pi_L\ (L\!\in\!U)\,\rangle\ =\ \{\boldsymbol\Pi_L\}\ ,\ \ \boldsymbol\Pi_L^2=\boldsymbol\Pi_L\ }
$$

性质：幂等、交换；合成等价 $\boldsymbol\Pi_L\circ\boldsymbol\Pi_M=\boldsymbol\Pi_{\min(L,M)}\ \cong\ (U,\min)$。

4. **首裁剪幂子幺半群**

$$
\boxed{\ \mathsf{M}_{\text{head}}(U)\ :=\ \{\mathbf{Head}_L\}\ ,\ \ \mathbf{Head}_L^2=\mathbf{Head}_L\ }
$$

与上同构（$(U,\min)$）。

5. **测试幂子幺半群**（KAT tests）

$$
\boxed{\ \mathsf{M}_{\text{test}}(\mathcal C,U)\ :=\ \langle\,\mathbf T_{L,\mathcal C}^{\text{Suf/Pref}}\,\rangle\ =\ \{\mathbf T_{P}\}\ ,\ \ \mathbf T_P^2=\mathbf T_P}
$$

性质：幂等、可交换；$\mathbf T_P\circ\mathbf T_Q=\mathbf T_{P\wedge Q}$（与“谓词合取”同构的 meet-半格）。

6. **闭包幂子幺半群—后缀闭包**（命中即停）

$$
\boxed{\ \mathsf{M}_{\text{cl-suf}}(U,L_p)\ :=\ \langle\,\mathbf{Cl}^{\text{Suf}}_{U,L_p}\,\rangle\ =\ \{\mathrm{id},\ \mathbf{Cl}^{\text{Suf}}_{U,L_p}\}\ ,\ \ (\mathbf{Cl})^2=\mathbf{Cl}}
$$

7. **闭包幂子幺半群—前缀闭包**（历史左扩直到命中）

$$
\boxed{\ \mathsf{M}_{\text{cl-pref}}(U)\ :=\ \langle\,\mathbf{Cl}^{\text{Pref}}_{U}\,\rangle\ =\ \{\mathrm{id},\ \mathbf{Cl}^{\text{Pref}}_{U}\}\ }
$$

（若采用“至多 $N$ 步”的截断闭包，则 $\langle\mathbf{Cl}^{\text{Pref}}_{U,N}\rangle=\{\mathbf{Cl}^{\text{Pref}}_{U,kN}\mid k\!\ge\!0\}$，随 $k$ 递增，至命中后稳定。）

8. **规范化幂子幺半群**（去重/清洗）

$$
\boxed{\ \mathsf{M}_{\text{norm}}\ :=\ \langle\,\mathbf D_{\text{head}},\ \mathbf{CJK}\,\rangle\ =\ \{\mathbf D_{\text{head}},\ \mathbf{CJK},\ \mathbf D_{\text{head}}\!\circ\!\mathbf{CJK},\dots\}\ }
$$

生成元幂等；产品一般非幂等但封闭。

---

### 二、**二元/多元复合的幂子幺半群（流程层）**

9. **乘-闭包幂子幺半群**

* 右向（bigram/前向拓扑母式）

$$
\boxed{\ \mathsf{M}_{R\!-\!Cl}(\chi;U,L_p)\ :=\ \langle\,\mathbf R_\chi,\ \mathbf{Cl}^{\text{Suf}}_{U,L_p}\,\rangle\ =\ \{\,\mathbf{Cl}^{\text{Suf}}_{U,L_p}\!\circ\!\mathbf R_{\chi^{n}}\mid n\!\ge\!0\,\}}
$$

（利用 $(\mathbf{Cl})^2=\mathbf{Cl}$ 归并出规范形。）

* 左向（历史拼接 + 前缀闭包）

$$
\boxed{\ \mathsf{M}_{L\!-\!Cl}(h;U)\ :=\ \langle\,\mathbf L_h,\ \mathbf{Cl}^{\text{Pref}}_{U}\,\rangle\ =\ \{\,\mathbf{Cl}^{\text{Pref}}_{U}\!\circ\!\mathbf L_{h^{n}}\mid n\!\ge\!0\,\}}
$$

10. **裁剪-乘子幂子幺半群**（观测构建母式）

$$
\boxed{\ \mathsf{M}_{\Pi\!-\!R}(L_h;w)\ :=\ \langle\,\boldsymbol\Pi_{L_h},\ \mathbf R_{w}\,\rangle\ =\ \{\,\mathbf R_{w^{n}}\!\circ\!\boldsymbol\Pi_{L_h}\mid n\!\ge\!0\,\}}
$$

（$w$ 为固定模板，如 “<sep>χ<eos>” 的拼接片段。）

11. **测试-闭包核幂子幺半群（KAT-核）**

$$
\boxed{\ \mathsf{M}_{\text{KAT-core}}\ :=\ \langle\,\mathbf T_{\bullet},\ \mathbf{Cl}^{\text{Suf}}_{U,L_p},\ \mathbf{Cl}^{\text{Pref}}_{U}\,\rangle }
$$

完全由幂等元生成；是“以 tests 与闭包为核”的可审计子幺半群。

12. **合规管线幂子幺半群**（生产可回放序列）

$$
\boxed{\ \mathsf{M}_{\text{pipeline}}\ :=\ \langle\,\mathbf T_{\text{legal}},\ \mathbf{Cl}^{\text{Pref}}_{U},\ \mathbf T_{\text{budget}},\ \mathbf{Cl}^{\text{Suf}}_{U,L_p},\ \mathbf{CJK}\,\rangle }
$$

以 tests→闭包→tests→闭包→清洗为生成序，所有幂次与排列的合成均在其中封闭；在有限词典/索引上，存在 $k^\star$ 使管线幂序列 $F^{k}$ 于 $k\!\ge\!k^\star$ 稳定（到达固定点）。

---

### 三、**两类“核级”幂子幺半群（工程优先使用）**

A) **E-核幂子幺半群（Idempotent-generated）**

$$
\boxed{\ \mathsf{M}_{E}\ :=\ \langle\,\boldsymbol\Pi_{\bullet},\ \mathbf{Head}_{\bullet},\ \mathbf T_{\bullet},\ \mathbf{Cl}^{\text{Suf}}_{U,L_p},\ \mathbf{Cl}^{\text{Pref}}_{U},\ \mathbf D_{\text{head}},\ \mathbf{CJK}\,\rangle }
$$

说明：全部由幂等生成元生成；用于**可审计/可回放**与**形式化等价化简**。

B) **乘-闭包核幂子幺半群（Action-Closure）**

$$
\boxed{\ \mathsf{M}_{\text{ActCl}}\ :=\ \langle\,\mathbf L_{h_i},\ \mathbf R_{g_j},\ \mathbf{Cl}^{\text{Pref}}_{U},\ \mathbf{Cl}^{\text{Suf}}_{U,L_p}\,\rangle }
$$

说明：把“拼接动作”与“命中闭包”合并成规范形（闭包∘若干乘子），是**预测/历史拓扑**复用最频繁的子幺半群。

---

### 四、**用法口径（工程建议）**

* 需要“**强可解释/强审计**”的业务侧，优先工作在 $\mathsf{M}_{E}$ 与 $\mathsf{M}_{\text{pipeline}}$。
* 需要“**高通量预测**”的在线侧，优先工作在 $\mathsf{M}_{R\!-\!Cl}$、$\mathsf{M}_{L\!-\!Cl}$ 与 $\mathsf{M}_{\Pi\!-\!R}$。
* 单元测试与等式化简，使用投影带 $\mathsf{M}_{\text{tail}}$、$\mathsf{M}_{\text{head}}$ 与测试幂子幺半群 $\mathsf{M}_{\text{test}}$ 的幂等与交换律做**规约**。

---

**许可声明 (License)**

Copyright (C) 2025 GaoZheng

本文档采用[知识共享-署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh-Hans)进行许可。
