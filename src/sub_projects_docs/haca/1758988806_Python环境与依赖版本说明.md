# Python环境与依赖版本说明

- 作者：GaoZheng
- 日期：2025-09-28
- 版本：v1.0.0

## 摘要
本文说明本项目推荐的 Python 版本与核心依赖的建议版本范围，并提供一键部署与版本自检的方法。推荐使用 Python 3.10 并在项目根目录创建本地虚拟环境（.venv）。依赖分为基础科学计算（numpy）、深度学习（PyTorch CPU 版）与可选组件（中文分词 jieba、LTP，以及生成提交信息的 google-generativeai）。文末附带快速校验命令与常见问题，帮助在 Windows/PowerShell 与 CMD 环境下快速落地。建议通过根目录脚本 setup_python_env.cmd 自动完成安装与验证。

---

- 推荐 Python：3.10（优先；3.11+ 可能存在轮子覆盖差异）
- 基础依赖：numpy（科学计算）
- 深度学习：torch（CPU 版，官方 index：https://download.pytorch.org/whl/cpu）
- 可选依赖：jieba、ltp、google-generativeai（提交信息自动生成）
- 一键部署：使用根目录脚本 setup_python_env.cmd，可加 --trace 查看过程

---

- Python：3.10（建议）。若使用 3.13，部分轮子可能尚未提供，安装将回退或失败。
- numpy：≥ 2.0（安装失败时可尝试仅二进制轮子 `--only-binary=:all:`）。
- torch（CPU）：依赖操作系统与 Python 版本，建议直接使用官方 CPU 源自动匹配：
  - `pip install --upgrade torch --index-url https://download.pytorch.org/whl/cpu`
- jieba：≥ 0.42；ltp：≥ 4.0；google-generativeai：≥ 0.7（可选）。

## 2. 一键部署

- CMD（默认安装 NLP 与 AI 组件）：
  - `setup_python_env.cmd`
  - 追踪执行：`setup_python_env.cmd --trace`
- 可选参数：
  - `--envdir <dir>` 指定虚拟环境目录（默认 `.venv`）
  - `--requirements <path>` 先从清单安装
  - `--no-nlp` 不安装 jieba/ltp；`--no-ai` 不安装 google-generativeai

## 3. 手动部署（示例）

```
# Windows（建议在项目根目录）
py -3.10 -m venv .venv
.\.venv\Scripts\activate
python -m pip install -U pip setuptools wheel
python -m pip install -U numpy
python -m pip install -U torch --index-url https://download.pytorch.org/whl/cpu
# 可选
python -m pip install -U jieba ltp google-generativeai
```

## 4. 版本自检

```
python - <<PY
import sys, numpy as np
print('Python :', sys.version)
print('numpy  :', np.__version__)
try:
    import torch
    print('torch  :', torch.__version__, 'cuda:', torch.cuda.is_available())
except Exception as e:
    print('torch  : not available ->', e)
try:
    import jieba; print('jieba  :', getattr(jieba, '__version__', 'unknown'))
except Exception:
    print('jieba  : not installed')
try:
    import ltp; print('ltp    :', getattr(ltp, '__version__', 'unknown'))
except Exception:
    print('ltp    : not installed')
PY
```

## 5. 常见问题

- 终端显示中文乱码：在 PowerShell 中将输出编码切换到 UTF-8，或使用 IDE 终端。
- `.venv` 未被 IDE 识别：在解释器选择中手动指定 `项目根/.venv/Scripts/python.exe`。
- torch 无法安装：多为 Python 版本与轮子不匹配，优先使用 3.10；或稍后重试官方 CPU 源。

---

**许可声明 (License)**

Copyright (C) 2025 GaoZheng

本文档采用[知识共享-署名-非商业性使用-禁止演绎 4.0 国际许可协议 (CC BY-NC-ND 4.0)](https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh-Hans)进行许可。
